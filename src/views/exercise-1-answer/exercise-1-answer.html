{% extends "views/_base/base.html" %}

{% block navigation %}
<nav class="cc-navigation">
	<a href="/" class="cc-back-link">&#8592; back to overview</a>
	<a href="/exercise-2" class="cc-answer-link">Exercise 2 &#8594;</a>
</nav>
{% endblock %}
{% block introduction %}
{# TODO: add title and description of exercise #}
<h1>Options Object</h1>
<p>Because the animator is initialized with a class, this opens up a lot of possibilities.</p>
<p>It allows an options object to be passed to the worklet, so we can for example work with timeline factors</p>

<ol>
	<li>Add a constructor to the class that takes an options object</li>
	<li>Use a custom option to multiply the timeline by, making it run slower or faster depending on the factor</li>
	<li>Pass an options object containing a factor of <code>0.5</code> as the last argument of one of the WorkletAnimations
		so it runs on half speed</li>
</ol>

<strong>I'm sure you can think of many ways to use this, you could for example create a boolean that toggles the sinus timeline on or off</strong>
{% endblock %}

{% block html %}
<section class="cc-html-playground">
	<div class="block" id="a">
		<svg class="cc-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 154.67 153.96">
			<path fill="#0000ff" d="M.9 21.54c-3.5 20.26 3.4 48.96 19.5 77 16.16 28 37.6 48.3 56.9 55.43V0C45 0 16.7 8.4.9 21.54z"></path>
			<path fill="#EDDD3E" d="M134.22 98.53c16.16-28 23.05-56.72 19.56-76.98C137.98 8.4 109.7 0 77.3 0v153.96c19.32-7.16 40.8-27.46 56.9-55.43z"></path>
			<path fill="#FFFFFF" d="M115.57 25.24c-4.52-1.3-9.33-2.33-14.33-3.13-.06 2.2-.17 4.4-.33 6.7-.3 5.1-.9 10.4-1.6 15.6 3.3 1 6.2 2.3 8.5 3.7.1 3.2-.4 6.9-1.4 10.8-1.5 6.2-4.2 12.8-7.9 19-3.6 6.3-7.9 12-12.5 16.4-2.9 2.8-5.8 5.1-8.6 6.6-2.7-1.5-5.7-3.8-8.6-6.6-4.5-4.4-8.9-10-12.5-16.3-3.6-6.3-6.3-12.8-7.9-19-1-3.9-1.4-7.6-1.4-10.8 2.4-1.4 5.3-2.6 8.6-3.7C54.9 39.3 54.3 34 54 29c-.15-2.4-.26-4.6-.32-6.72-5 .8-9.8 1.84-14.3 3.13-7.3 2.1-13.7 4.8-18.8 7.8-.1 6 .8 12.8 2.7 20.2 2.86 11.5 8 23.8 14.8 35.6 6.8 11.8 14.9 22.4 23.4 30.6 5.44 5.3 10.9 9.5 16.1 12.4 5.2-2.9 10.66-7.1 16.13-12.4 8.5-8.2 16.6-18.8 23.4-30.6 6.8-11.8 12-24.1 14.8-35.6 1.9-7.4 2.8-14.2 2.7-20.2-5-3-11.4-5.7-18.7-7.7z"></path>
			<path fill="#EAEAEA" d="M77.33 100.83c-2.78-1.56-5.7-3.8-8.62-6.62-4.5-4.4-8.8-10-12.5-16.3-3.6-6.3-6.3-12.8-7.9-19-1-3.9-1.4-7.6-1.4-10.8 2.4-1.4 5.3-2.6 8.6-3.7-.7-5.2-1.3-10.5-1.6-15.5l-.3-6.7c-5 .8-9.8 1.9-14.3 3.2-7.3 2.1-13.7 4.8-18.8 7.8-.1 6 .8 12.8 2.7 20.2 2.9 11.5 8 23.8 14.8 35.6 6.8 11.8 14.9 22.4 23.4 30.7 5.5 5.3 10.9 9.5 16.1 12.4v-31z"></path>
		</svg>
	</div>
	<div class="block" id="b">
		<svg class="cc-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 154.67 153.96">
			<path fill="#0000ff" d="M.9 21.54c-3.5 20.26 3.4 48.96 19.5 77 16.16 28 37.6 48.3 56.9 55.43V0C45 0 16.7 8.4.9 21.54z"></path>
			<path fill="#EDDD3E" d="M134.22 98.53c16.16-28 23.05-56.72 19.56-76.98C137.98 8.4 109.7 0 77.3 0v153.96c19.32-7.16 40.8-27.46 56.9-55.43z"></path>
			<path fill="#FFFFFF" d="M115.57 25.24c-4.52-1.3-9.33-2.33-14.33-3.13-.06 2.2-.17 4.4-.33 6.7-.3 5.1-.9 10.4-1.6 15.6 3.3 1 6.2 2.3 8.5 3.7.1 3.2-.4 6.9-1.4 10.8-1.5 6.2-4.2 12.8-7.9 19-3.6 6.3-7.9 12-12.5 16.4-2.9 2.8-5.8 5.1-8.6 6.6-2.7-1.5-5.7-3.8-8.6-6.6-4.5-4.4-8.9-10-12.5-16.3-3.6-6.3-6.3-12.8-7.9-19-1-3.9-1.4-7.6-1.4-10.8 2.4-1.4 5.3-2.6 8.6-3.7C54.9 39.3 54.3 34 54 29c-.15-2.4-.26-4.6-.32-6.72-5 .8-9.8 1.84-14.3 3.13-7.3 2.1-13.7 4.8-18.8 7.8-.1 6 .8 12.8 2.7 20.2 2.86 11.5 8 23.8 14.8 35.6 6.8 11.8 14.9 22.4 23.4 30.6 5.44 5.3 10.9 9.5 16.1 12.4 5.2-2.9 10.66-7.1 16.13-12.4 8.5-8.2 16.6-18.8 23.4-30.6 6.8-11.8 12-24.1 14.8-35.6 1.9-7.4 2.8-14.2 2.7-20.2-5-3-11.4-5.7-18.7-7.7z"></path>
			<path fill="#EAEAEA" d="M77.33 100.83c-2.78-1.56-5.7-3.8-8.62-6.62-4.5-4.4-8.8-10-12.5-16.3-3.6-6.3-6.3-12.8-7.9-19-1-3.9-1.4-7.6-1.4-10.8 2.4-1.4 5.3-2.6 8.6-3.7-.7-5.2-1.3-10.5-1.6-15.5l-.3-6.7c-5 .8-9.8 1.9-14.3 3.2-7.3 2.1-13.7 4.8-18.8 7.8-.1 6 .8 12.8 2.7 20.2 2.9 11.5 8 23.8 14.8 35.6 6.8 11.8 14.9 22.4 23.4 30.7 5.5 5.3 10.9 9.5 16.1 12.4v-31z"></path>
		</svg>
	</div>
</section>
{% endblock %}

{% block styles %}
<style type="text/css">
	.block {
		width: 200px;
		height: 200px;
		margin-bottom: 10px;
	}
	code {
		font-family: MyFancyCustomFont, monospace;
		font-size: inherit;
		background: #ffeff0;
		word-wrap: break-word;
		box-decoration-break: clone;
		padding: .1rem .3rem .2rem;
		border-radius: .2rem;
	}
</style>
{% endblock %}

{% block scripts %}
<script language="javascript+animationworklet" type="javascript">
	registerAnimator('factor', class {
		constructor(options = {}) {
			this.factor = options.factor || 1;
		}
		animate(currentTime, effect) {
			console.log(currentTime), effect;
			effect.localTime = currentTime * this.factor;
		}
	});
</script>
<script>
	if(!('animationWorklet' in CSS)) {
		document.write("You need AnimationWorklet to see this demo :(");
	}

	function urlFromTag(sel) {
		const el = document.querySelector(sel);
		if(!el) {
			throw new Error("Couldn't find element");
		}
		const blob = new Blob([el.textContent], {type: "text/javascript"});
		return URL.createObjectURL(blob);
	}
	async function init() {
		await CSS.animationWorklet.addModule(urlFromTag("script[language='javascript+animationworklet']"));

		new WorkletAnimation(
				'factor',
				new KeyframeEffect(
						document.querySelector('#a'),
						[
							{
								transform: 'translateX(0)'
							},
							{
								transform: 'translateX(500px)'
							}
						],
						{
							duration: 2000,
							iterations: Number.POSITIVE_INFINITY
						}
				),
				document.timeline
		).play();

		new WorkletAnimation(
				'factor',
				new KeyframeEffect(
						document.querySelector('#b'),
						[
							{
								transform: 'translateX(0)'
							},
							{
								transform: 'translateX(500px)'
							}
						],
						{
							duration: 2000,
							iterations: Number.POSITIVE_INFINITY
						}
				),
				document.timeline,
				{factor: 0.5}
		).play();
	}
	init();
</script>
{% endblock %}
